<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Conti Train Board</title>

<style>
body {
    margin: 0; padding: 0;
    background: black; color: #ffb000;
    font-family: "Courier New", monospace;
    font-size: 16px;
}
h1,h2 { text-align:center; margin:10px; }
input, button {
    font-family: "Courier New", monospace;
    font-size: 16px;
    margin:5px; padding:6px;
    background:black; color:#ffb000;
    border:1px solid #ffb000;
}
button:hover { background:#222; cursor:pointer; }

#boardContainer {
    width:100%; height:350px; overflow:hidden;
    border-top:2px solid #ffb000; border-bottom:2px solid #ffb000;
}
#departureTable { border-collapse:collapse; width:100%; }
th, td { padding:4px 6px; text-align:left; }
th { border-bottom:2px solid #ffb000; }
.expandable { cursor:pointer; }
.expandable:hover { background:#111; }
.stop-details { background:#111; display:none; padding-left:10px; }
.highlight { background:#550000; color:#ffb000; font-weight:bold; }
.scroller { display:block; animation: scrollUp 15s linear infinite; }
@keyframes scrollUp { 0%{ transform:translateY(0); } 100%{ transform:translateY(-100%); } }
</style>
</head>
<body>

<h1>Conti Train Board</h1>

<!-- Station -->
<div>
    <input id="stationInput" placeholder="Enter station name">
    <button onclick="showDepartures()">Show Departures</button>
    <button onclick="useDefault()">Default Station</button>
</div>

<!-- Preferred train -->
<div>
    <input id="preferredDest" placeholder="Preferred train destination">
    <input id="preferredTime" placeholder="Departure time HH:MM">
    <button onclick="setPreferredTrain()">Set Preferred Train</button>
</div>

<div id="boardContainer">
<table id="departureTable"></table>
</div>

<hr style="border:1px solid #ffb000; margin:15px 0;">

<h2>JOURNEY PLANNER</h2>
<div>
    <input id="fromInput" placeholder="From station">
    <input id="toInput" placeholder="To station">
    <input id="dateInput" type="date">
    <input id="timeInput" type="time" value="12:00">
    <button onclick="planJourney()">Find Routes</button>
</div>

<table id="journeyTable"></table>

<script>
// ===== Minimal Test Data =====
const DEFAULT_STATION = "Wallington";
let PREFERRED_TRAIN = { destination:"", aimed_departure_time:"" };

const dummyDepartures = [
  { aimed_departure_time:"14:28", destination_name:"London Euston", platform:"2", status:"On time", service_timetable:{id:1}, stops:[
    { station_name:"Wallington", aimed_arrival_time:"14:28" },
    { station_name:"Clapham Junction", aimed_arrival_time:"14:40" },
    { station_name:"London Euston", aimed_arrival_time:"15:15" }
  ]},
  { aimed_departure_time:"14:40", destination_name:"Guildford", platform:"3", status:"Delayed", service_timetable:{id:2}, stops:[
    { station_name:"Wallington", aimed_arrival_time:"14:40" },
    { station_name:"Earlswood", aimed_arrival_time:"14:55" },
    { station_name:"Guildford", aimed_arrival_time:"15:25" }
  ]},
  { aimed_departure_time:"14:50", destination_name:"Reigate", platform:"1", status:"On time", service_timetable:{id:3}, stops:[
    { station_name:"Wallington", aimed_arrival_time:"14:50" },
    { station_name:"Redhill", aimed_arrival_time:"15:10" },
    { station_name:"Reigate", aimed_arrival_time:"15:20" }
  ]}
];

// ===== Functions =====
function setPreferredTrain(){
    const dest = document.getElementById("preferredDest").value.trim();
    const time = document.getElementById("preferredTime").value.trim();
    if(dest && time){ PREFERRED_TRAIN.destination=dest; PREFERRED_TRAIN.aimed_departure_time=time; alert(`Preferred train set: ${dest} at ${time}`);}
    else alert("Enter both destination and time");
}

function useDefault(){ document.getElementById("stationInput").value=DEFAULT_STATION; showDepartures(); }

function showDepartures(){
    const table=document.getElementById("departureTable");
    table.innerHTML=`<tr><th colspan="4">Departures from ${DEFAULT_STATION.toUpperCase()}</th></tr>
    <tr><th>Time</th><th>Destination</th><th>Plat</th><th>Status</th></tr>`;

    const scroller = document.createElement("tbody"); scroller.classList.add("scroller");

    dummyDepartures.forEach(train=>{
        const row=document.createElement("tr"); row.classList.add("expandable");
        if(train.destination_name===PREFERRED_TRAIN.destination && train.aimed_departure_time===PREFERRED_TRAIN.aimed_departure_time && train.status.toLowerCase().includes("delay")) row.classList.add("highlight");
        row.innerHTML=`<td>${train.aimed_departure_time}</td><td>${train.destination_name}</td><td>${train.platform}</td><td>${train.status}</td>`;
        row.onclick=()=>showStops(train, row);
        scroller.appendChild(row);
    });

    table.appendChild(scroller);
    checkPreferredTrain(dummyDepartures);
}

function showStops(train,row){
    const next=row.nextSibling; if(next && next.classList && next.classList.contains("stop-details")){next.remove(); return;}
    const detail=document.createElement("tr"); detail.classList.add("stop-details");
    detail.innerHTML=`<td colspan="4"><b>Stops:</b><br>${train.stops.map(s=>`${s.aimed_arrival_time} - ${s.station_name}`).join("<br>")}</td>`;
    row.after(detail);
}

function checkPreferredTrain(departures){
    if(!PREFERRED_TRAIN.destination || !PREFERRED_TRAIN.aimed_departure_time) return;
    const train=departures.find(t=>t.destination_name===PREFERRED_TRAIN.destination && t.aimed_departure_time===PREFERRED_TRAIN.aimed_departure_time);
    if(train && train.status.toLowerCase().includes("delay")) alert(`⚠️ Your preferred train to ${PREFERRED_TRAIN.destination} at ${PREFERRED_TRAIN.aimed_departure_time} is ${train.status}`);
}

function planJourney(){
    const from=document.getElementById("fromInput").value.trim();
    const to=document.getElementById("toInput").value.trim();
    const date=document.getElementById("dateInput").value;
    const time=document.getElementById("timeInput").value;
    if(!from || !to || !date || !time){alert("Fill all fields"); return;}

    const table=document.getElementById("journeyTable");
    table.innerHTML=`<tr><th colspan="4">Journey Results</th></tr>
        <tr><th>Dep Time</th><th>Arr Time</th><th>Route</th><th>Status</th></tr>
        <tr><td>14:28</td><td>15:15</td><td>${from}→Clapham Junction→${to}</td><td>On time</td></tr>
        <tr><td>14:40</td><td>15:25</td><td>${from}→Earlswood→${to}</td><td>Delayed</td></tr>`;
}

// Auto-load
showDepartures();
setInterval(showDepartures,30000);
</script>
</body>
</html>
